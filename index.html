<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZXY视频网站 - 在线视频解析</title>
    <meta name="description" content="ZXY视频网站提供简洁高效的在线视频解析工具，支持主流视频平台。">
    <meta name="keywords" content="ZXY视频, 视频解析, 在线解析, VIP视频解析, 免广告看视频">
    <!-- Preload Fonts and Icons for performance -->
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" as="style" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" as="style">

    <!-- Fonts and Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        /* --- CSS Reset & Base Styles --- */
        *,
        *::before,
        *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        :root {
            /* == 全新色彩方案 == */
            --primary-gradient: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%); /* 主渐变色 (紫 -> 蓝) */
            --primary-color-start: #6a11cb; /* 渐变起始色 */
            --primary-color-end: #2575fc; /* 渐变结束色 */
            --accent-color: #34e89e; /* 强调色 (亮青绿) */
            --accent-hover: #2bc48a;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --danger-hover: #c82333;
            --success-color: #28a745; /* 保留，或使用 accent-color */

            /* == 背景与文本色 == */
            --body-bg: linear-gradient(to top, #f3e7e9 0%, #e3eeff 100%); /* 柔和渐变背景 (粉 -> 蓝) */
            --container-bg: rgba(255, 255, 255, 0.95); /* 容器背景，轻微透明 */
            --card-bg: #ffffff; /* 卡片背景 */
            --text-color: #333; /* 深灰色文本 */
            --text-light: #667; /* 浅灰色文本 */
            --border-color: rgba(0, 0, 0, 0.08); /* 更柔和的边框色 */

            /* == 阴影与圆角 == */
            --shadow-light: rgba(0, 0, 0, 0.06);
            --shadow-medium: rgba(0, 0, 0, 0.1);
            --shadow-strong: rgba(50, 50, 93, 0.15); /* 更自然的阴影 */
            --border-radius-sm: 8px;
            --border-radius-md: 16px; /* 更大的圆角 */
            --border-radius-lg: 24px;

            /* == 动画与过渡 == */
            --animation-speed: 0.3s;
            --transition-smooth: all var(--animation-speed) cubic-bezier(0.25, 0.8, 0.25, 1); /* 平滑过渡 */

            /* 移动端限制接口提示 */
            --restricted-interface-bg: rgba(255, 193, 7, 0.1);
            --restricted-interface-color: #b98900;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Poppins', sans-serif;
            color: var(--text-color);
            /* == 应用渐变背景 == */
            background: var(--body-bg);
            background-attachment: fixed; /* 固定背景 */
            line-height: 1.7; /* 增加行高 */
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 3rem 1rem; /* 增加上下内边距 */
            overflow-x: hidden;
        }

        /* --- 主容器 --- */
        .container {
            width: 100%;
            max-width: 950px; /* 稍微加宽 */
            background-color: var(--container-bg);
            padding: 3rem 3.5rem; /* 增加内边距 */
            border-radius: var(--border-radius-lg); /* 大圆角 */
            /* == 精致阴影 == */
            box-shadow: 0 15px 35px var(--shadow-strong), 0 5px 15px rgba(0,0,0,0.07);
            backdrop-filter: blur(5px); /* 轻微模糊背景 (如果浏览器支持) */
            border: 1px solid rgba(255, 255, 255, 0.2); /* 细微边框增加质感 */
            animation: fadeInScale 0.8s ease-out forwards;
            opacity: 0;
            transform: scale(0.97); /* 初始稍微缩小 */
        }

        @keyframes fadeInScale {
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* --- 排版 --- */
        h1 {
            /* == 渐变文字标题 == */
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            filter: drop-shadow(0 2px 3px rgba(0,0,0,0.1)); /* 文字轻微阴影 */

            text-align: center;
            margin-bottom: 2.5rem; /* 增加 H1 下方间距 */
            font-weight: 700; /* 加粗 */
            font-size: 2.5rem; /* 增大字号 */
            letter-spacing: -1px; /* 调整字间距 */
        }
        h1 i { margin-right: 0.8rem; /* 图标与文字间距 */ }

        h2 {
            color: var(--primary-color-start); /* 使用渐变起始色 */
            margin-top: 3rem; /* 增加 H2 上方间距 */
            margin-bottom: 1.5rem;
            font-weight: 600;
            padding-bottom: 0.8rem;
            border-bottom: 2px solid var(--border-color);
            display: flex; /* 让图标和文字对齐 */
            align-items: center;
            gap: 0.6rem; /* 图标和文字间距 */
        }

        p {
            margin-bottom: 1.2rem;
            color: var(--text-light);
        }

        strong {
            color: var(--text-color);
            font-weight: 600; /* 加强 strong 效果 */
        }

        /* --- 按钮 --- */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.6rem;
            padding: 0.85rem 1.8rem; /* 调整按钮大小 */
            font-size: 1rem;
            font-weight: 500;
            color: #fff;
            /* == 渐变背景按钮 == */
            background: var(--primary-gradient);
            border: none;
            border-radius: var(--border-radius-md); /* 中等圆角 */
            cursor: pointer;
            transition: var(--transition-smooth);
            text-decoration: none;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
            z-index: 1;
        }

        .btn:hover {
            /* == 悬停效果：提升、阴影加深、轻微变亮 == */
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            filter: brightness(1.1);
        }

        .btn:active {
            transform: translateY(-1px) scale(0.98);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            filter: brightness(0.95);
        }

        .btn:disabled {
            background: #adb5bd;
            cursor: not-allowed;
            box-shadow: none;
            transform: none;
            filter: none;
            opacity: 0.65;
        }

        /* 按钮涟漪效果 (保持) */
        .btn::after { /* ... 省略已有代码 ... */ }
        .btn:focus:not(:active)::after { /* ... 省略已有代码 ... */ }
        @keyframes ripple { /* ... 省略已有代码 ... */ }

        .platform-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 1.2rem; /* 增加按钮间距 */
            justify-content: center;
            margin-bottom: 3rem; /* 增加下方间距 */
        }

        .platform-btn {
            flex-grow: 1;
            min-width: 130px; /* 稍微增大最小宽度 */
            /* 可以给平台按钮不同的颜色或样式，但当前保持统一 */
        }

        /* 特别突出“自动测试”和“立即解析”按钮 */
        #autoTestButton {
            background: linear-gradient(135deg, var(--accent-color) 0%, var(--accent-hover) 100%);
        }
        #parseButton {
            /* 使用主渐变色，已默认 */
        }


        /* --- 表单元素 --- */
        .parser-form {
            display: grid;
            gap: 1.5rem; /* 增加表单元素间距 */
            margin-bottom: 2.5rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-label {
            margin-bottom: 0.7rem; /* 增加标签和输入框间距 */
            font-weight: 500;
            color: var(--primary-color-start); /* 标签颜色 */
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .form-label i { color: var(--primary-color-end); }

        .form-control {
            width: 100%;
            padding: 0.9rem 1.2rem; /* 增加内边距 */
            background-color: #fff;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-md); /* 中等圆角 */
            color: var(--text-color);
            font-size: 1rem;
            font-family: inherit;
            transition: border-color var(--animation-speed) ease, box-shadow var(--animation-speed) ease;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.05); /* 轻微内阴影 */
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-color-end);
            /* == 更柔和的发光效果 == */
            box-shadow: 0 0 0 4px rgba(37, 117, 252, 0.15), inset 0 1px 3px rgba(0,0,0,0.05);
        }

        select.form-control {
            appearance: none;
            /* == 自定义下拉箭头 (SVG) == */
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="%236a11cb"><path fill-rule="evenodd" d="M4.646 5.646a.5.5 0 0 1 .708 0L8 8.293l2.646-2.647a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 0 1 0-.708z"/></svg>');
            background-repeat: no-repeat;
            background-position: right 1.2rem center;
            background-size: 1.2em; /* 增大箭头 */
            padding-right: 3.5rem; /* 为箭头留出空间 */
        }

        .form-control option.restricted-mobile {
            background-color: var(--restricted-interface-bg);
            color: var(--restricted-interface-color);
            font-style: italic;
        }
        /* 给 select 下拉选项增加一点 padding */
        .form-control option {
            padding: 5px 10px;
        }

        .parser-actions {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-top: 0.5rem; /* 微调上方间距 */
        }

        .parser-actions .btn {
            flex-grow: 1;
        }

        /* --- 说明框 --- */
        .instructions {
            /* == 更融入主题的样式 == */
            background-color: rgba(230, 240, 255, 0.5); /* 淡蓝色半透明 */
            border-left: 6px solid var(--primary-color-end); /* 蓝色边框 */
            padding: 1.8rem 2rem; /* 增加内边距 */
            margin-bottom: 3rem;
            border-radius: var(--border-radius-md); /* 中圆角 */
            font-size: 0.98rem; /* 微调字号 */
            box-shadow: 0 4px 10px var(--shadow-light);
        }
        .instructions p:last-child { margin-bottom: 0; }
        .instructions strong { color: var(--primary-color-start); font-weight: 600; }
        .instructions strong i { color: var(--primary-color-end); }
        .instructions ol { padding-left: 1.8rem; margin-bottom: 1.2rem; list-style-type: decimal-leading-zero; }
        .instructions li { margin-bottom: 0.5rem; }


        /* --- 视频播放器 --- */
        .video-container {
            position: relative;
            width: 100%;
            padding-bottom: 56.25%; /* 16:9 */
            border-radius: var(--border-radius-md); /* 中圆角 */
            overflow: hidden;
            background-color: #111; /* 深色背景 */
            margin-top: 2.5rem; /* 增加上方间距 */
            display: none;
            box-shadow: 0 10px 30px var(--shadow-medium); /* 更明显的阴影 */
            animation: fadeIn 0.6s ease;
        }

        .video-iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }

        /* --- 状态消息 --- */
        .status-message {
            text-align: center;
            padding: 1rem 1.5rem; /* 增加内边距 */
            border-radius: var(--border-radius-md);
            margin-top: 2rem; /* 增加上方间距 */
            display: none;
            font-weight: 500;
            animation: slideDown 0.4s ease-out;
            border: 1px solid transparent;
            box-shadow: 0 3px 8px var(--shadow-light);
            display: flex; /* 使用 flex 布局让图标和文字更好对齐 */
            align-items: center;
            justify-content: center;
            gap: 0.8rem; /* 图标和文字间距 */
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .status-loading,
        .status-testing {
            background-color: rgba(255, 193, 7, 0.15); /* 加深一点背景 */
            color: #a37b00; /* 更深的黄色 */
            border-color: rgba(255, 193, 7, 0.4);
        }
        .status-error {
            background-color: rgba(220, 53, 69, 0.1);
            color: var(--danger-color);
            border-color: rgba(220, 53, 69, 0.4);
        }
        .status-success {
            background-color: rgba(40, 167, 69, 0.1);
            color: var(--success-color);
            border-color: rgba(40, 167, 69, 0.4);
        }

        /* --- 电影站点卡片 --- */
        .movie-sites {
            margin-top: 3.5rem; /* 增加上方间距 */
        }

        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); /* 增大最小宽度 */
            gap: 2rem; /* 增加卡片间距 */
            margin-top: 2rem; /* 增加上方间距 */
        }

        .movie-card {
            background-color: var(--card-bg);
            border-radius: var(--border-radius-md);
            overflow: hidden;
            box-shadow: 0 8px 20px var(--shadow-light); /* 初始较柔和阴影 */
            transition: var(--transition-smooth);
            text-decoration: none;
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            border: 1px solid var(--border-color);
        }

        .movie-card:hover {
            /* == 增强悬停效果 == */
            transform: translateY(-8px) scale(1.03);
            box-shadow: 0 15px 35px var(--shadow-medium);
            border-color: var(--primary-color-end); /* 悬停时边框变色 */
        }

        .movie-card-image {
            height: 140px; /* 增加图片区域高度 */
            /* == 更吸引人的渐变背景 == */
            background: linear-gradient(135deg, #f6d365 0%, #fda085 100%); /* 黄 -> 橙 */
            display: flex;
            align-items: center;
            justify-content: center;
            color: rgba(255, 255, 255, 0.8); /* 白色图标，带透明度 */
            font-size: 3.5rem; /* 增大图标 */
            transition: var(--transition-smooth);
        }
        .movie-card:hover .movie-card-image {
             background: linear-gradient(135deg, #fda085 0%, #f6d365 100%); /* 悬停时反转渐变 */
             color: #fff; /* 悬停时图标更亮 */
        }

        .movie-card-content {
            padding: 1.2rem; /* 增加内容区内边距 */
            text-align: center;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .movie-card-title {
            font-weight: 600;
            margin-bottom: 0.4rem;
            font-size: 1.15rem; /* 增大标题字号 */
            color: var(--primary-color-start); /* 标题颜色 */
            transition: color var(--animation-speed) ease;
        }
        .movie-card:hover .movie-card-title {
            color: var(--primary-color-end);
        }

        .movie-card-link {
            font-size: 0.88rem; /* 微调链接字号 */
            color: var(--text-light);
            word-break: break-all;
        }

        .movie-warning {
            margin-top: 1.5rem; /* 增加上方间距 */
            padding: 1.2rem; /* 增加内边距 */
            background-color: rgba(255, 193, 7, 0.1);
            color: #b98900;
            border: 1px solid rgba(255, 193, 7, 0.3);
            border-radius: var(--border-radius-md);
            font-size: 0.95rem; /* 微调字号 */
            text-align: center;
            display: flex; /* 图标和文字对齐 */
            align-items: center;
            justify-content: center;
            gap: 0.6rem;
            box-shadow: 0 3px 8px var(--shadow-light);
        }
        .movie-warning i { font-size: 1.1rem; }

        /* --- 页脚 --- */
        footer {
            text-align: center;
            margin-top: 4rem; /* 增加上方间距 */
            padding-top: 2rem;
            border-top: 1px solid var(--border-color);
            font-size: 0.9em;
            color: var(--text-light);
            opacity: 0.8; /* 让页脚不那么显眼 */
        }
        footer p { margin-bottom: 0.5rem; } /* 减小页脚段落间距 */

        /* --- 可访问性 --- */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        /* --- 响应式设计 --- */
        @media (max-width: 768px) {
            body { padding: 2rem 0.8rem; }
            .container { padding: 2.5rem 1.5rem; border-radius: var(--border-radius-md); } /* 调整容器内边距和圆角 */
            h1 { font-size: 2rem; } /* 调整标题大小 */
            .platform-buttons { flex-direction: column; gap: 0.8rem; margin-bottom: 2rem; }
            .platform-btn { width: 100%; padding: 0.8rem 1.5rem; }
            .parser-actions { flex-direction: column; gap: 0.8rem; }
             .parser-actions .btn { width: 100%; padding: 0.8rem 1.5rem; }
            .card-grid { grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 1.2rem; } /* 调整卡片布局 */
            .movie-card-image { height: 120px; font-size: 3rem; }
            .movie-card-title { font-size: 1.05rem; }
            h2 { font-size: 1.3rem; }
        }

         @media (max-width: 480px) {
             body { padding: 1.5rem 0.5rem; }
             .container { padding: 2rem 1rem; border-radius: var(--border-radius-sm); } /* 进一步调整 */
             h1 { font-size: 1.8rem; }
             .btn, .platform-btn, .parser-actions .btn { padding: 0.75rem 1.4rem; font-size: 0.95rem; }
             .form-control { padding: 0.8rem 1rem; font-size: 0.95rem; }
             select.form-control { background-position: right 0.8rem center; padding-right: 3rem; }
             .card-grid { grid-template-columns: 1fr 1fr; gap: 1rem; } /* 手机上固定两列 */
             .movie-card-image { height: 100px; font-size: 2.5rem; }
             .movie-card-title { font-size: 1rem; }
             .instructions { padding: 1.5rem 1.2rem; font-size: 0.92rem; }
             .movie-warning { padding: 1rem; font-size: 0.9rem; }
             footer { margin-top: 3rem; padding-top: 1.5rem; font-size: 0.85em; }
         }

    </style>
</head>
<body>

    <main class="container">
        <!-- H1 标题现在使用渐变文字 -->
        <h1><i class="fas fa-film fa-fw"></i> ZXY视频网站</h1>

        <!-- 平台按钮样式已更新 -->
        <nav class="platform-buttons" aria-label="视频平台导航">
            <a href="https://v.qq.com/" target="_blank" rel="noopener noreferrer" class="btn platform-btn" title="访问腾讯视频官网">
                <i class="fab fa-qq" aria-hidden="true"></i> 腾讯视频
            </a>
            <a href="https://www.iqiyi.com/" target="_blank" rel="noopener noreferrer" class="btn platform-btn" title="访问爱奇艺官网">
                <i class="fas fa-play-circle" aria-hidden="true"></i> 爱奇艺
            </a>
            <a href="https://www.bilibili.com/" target="_blank" rel="noopener noreferrer" class="btn platform-btn" title="访问哔哩哔哩官网">
                <i class="fas fa-tv" aria-hidden="true"></i> Bilibili
            </a>
            <!-- 你可以在这里添加更多平台按钮 -->
        </nav>

        <!-- 说明框样式已更新 -->
        <section class="instructions" aria-labelledby="instructions-heading">
            <h2 id="instructions-heading" class="sr-only">使用说明</h2>
            <p><strong><i class="fas fa-info-circle fa-fw"></i> 如何使用:</strong></p>
            <ol>
                <li>点击上方按钮前往视频平台，或直接打开视频网站。</li>
                <li>找到想看的视频，复制浏览器地址栏中的完整链接 (URL)。</li>
                <li>返回本页面，将链接粘贴到下方的输入框中。</li>
                <li>选择一个解析接口（推荐点击 <strong style="color: var(--accent-color);">自动测试</strong>）。</li>
                <li>点击 <strong style="color: var(--primary-color-end);">立即解析</strong> 按钮，稍等片刻即可播放。</li>
            </ol>
            <p><strong>注意：</strong> 若播放失败或卡顿，请尝试切换其他解析接口。本工具仅供学习交流，请勿用于非法用途。</p>
        </section>

        <!-- 表单样式已更新 -->
        <section class="parser-form" aria-labelledby="parser-heading">
            <h2 id="parser-heading" class="sr-only">视频解析器</h2>
            <div class="form-group">
                <label for="parserInterface" class="form-label"><i class="fas fa-server fa-fw"></i> 解析接口:</label>
                <!--
                    修改/添加/删除 解析接口:
                    1. 复制下面的一个 <option> ... </option> 标签行。
                    2. 修改 value="接口地址" 中的 "接口地址"，确保地址以 "?url=" 或类似的参数结尾。这是实际使用的接口链接。
                    3. 修改 > 和 </option> 之间的文本，这是下拉列表中显示的名称。
                    4. (可选) 如果某个接口在手机上可能有问题（如广告过多、兼容性差），可以添加 data-restricted-mobile="true" 属性，JS 会在手机访问时给出提示，并且样式中会标记。
                    5. 要删除接口，直接删除对应的 <option> ... </option> 行即可。
                    注意：请确保接口地址是真实有效的！以下仅为示例。
                -->
                <select id="parserInterface" class="form-control" aria-describedby="interface-description">
                    <option value="https://jx.xmflv.com/?url=" data-restricted-mobile="true">接口 1 (xmflv.com)</option>
                    <option value="https://bd.jx.cn/?url=">接口 2 (bd.jx.cn)</option>
                    <option value="https://jx.xmflv.cc/?url=" data-restricted-mobile="true">接口 3 (xmflv.cc)</option>
                    <option value="https://jx.hls.one/?url=">接口 4 (hls.one) [推荐]</option>
                    <option value="https://jx.77flv.cc/?url=">接口 5 (77flv.cc) [推荐]</option>
                    <option value="https://www.yemu.xyz/?url=" data-restricted-mobile="true">接口 6 (yemu.xyz)</option>
                    <!-- 在这里添加新的接口 -->
                    <option value="https://yparse.jn1.cc/index.php?url=">接口 7 (聚合) [备用]</option>
                    <option value="https://player.q168.vip/?url=">接口 8 (q168.vip) [备用]</option>
                </select>
                <small id="interface-description" class="text-light" style="margin-top: 0.5rem;">带 <i class="fas fa-mobile-alt fa-fw" style="color: var(--restricted-interface-color);"></i> 标记的接口在手机端可能体验不佳。</small>
            </div>

            <div class="form-group">
                <label for="videoUrl" class="form-label"><i class="fas fa-link fa-fw"></i> 视频链接:</label>
                <input type="url" id="videoUrl" class="form-control" placeholder="请在此处粘贴视频播放页面的完整链接..." required autocomplete="off">
            </div>

            <!-- 解析按钮样式已更新 -->
            <div class="parser-actions">
                <button class="btn" type="button" id="autoTestButton" title="自动测试查找可用接口">
                    <i class="fas fa-magic fa-fw" aria-hidden="true"></i> 自动测试
                </button>
                <button class="btn" type="button" id="parseButton" title="使用选定接口解析视频">
                    <i class="fas fa-play fa-fw" aria-hidden="true"></i> 立即解析
                </button>
            </div>
        </section>

        <!-- 状态消息样式已更新 -->
        <div class="status-message status-loading" id="loadingMessage" role="status" aria-live="polite"><i class="fas fa-spinner fa-spin fa-fw"></i> 解析中，请稍候...</div>
        <div class="status-message status-testing" id="testingInterfaceMessage" role="status" aria-live="polite"><i class="fas fa-vial fa-fw"></i> 正在自动测试接口...</div>
        <div class="status-message status-success" id="successMessage" role="status" aria-live="polite"><i class="fas fa-check-circle fa-fw"></i> 接口测试成功，已选择可用接口！</div>
        <div class="status-message status-error" id="errorMessage" role="alert" aria-live="assertive"><i class="fas fa-exclamation-triangle fa-fw"></i> <span id="errorText">发生错误</span></div>

        <!-- 视频播放器样式已更新 -->
        <div class="video-container" id="videoContainer">
            <iframe class="video-iframe" id="videoPlayer" title="视频播放器" allow="autoplay; fullscreen" allowfullscreen sandbox="allow-scripts allow-same-origin allow-popups"></iframe>
        </div>

        <!-- 影视站点推荐卡片样式已更新 -->
        <section class="movie-sites" aria-labelledby="movie-sites-heading">
            <!-- H2 标题样式已更新 -->
            <h2 id="movie-sites-heading"><i class="fas fa-tv fa-fw"></i> 免费影视站点推荐</h2>
            <!-- 警告框样式已更新 -->
            <div class="movie-warning">
                <i class="fas fa-exclamation-triangle"></i> <strong>注意:</strong> 以下网站非本站所有，内容可能包含广告、弹窗或潜在风险，请谨慎访问和使用！
            </div>
             <!--
                修改/添加/删除 推荐网站:
                1. 复制下面的一个 <a ... </a> 标签块 (从 <a href=...> 开始，到 </a> 结束)。
                2. 修改 href="网站链接" 中的 "网站链接"。
                3. 修改 <div class="movie-card-image"><i class="图标类名"></i></div> 中的 "图标类名"。你可以从 Font Awesome 官网 (fontawesome.com) 查找免费图标，例如 fas fa-film, fas fa-video, fas fa-desktop 等。
                4. 修改 <h3 class="movie-card-title">网站名称</h3> 中的 "网站名称"。
                5. 修改 <span class="movie-card-link">网站域名</span> 中的 "网站域名" (通常和链接一致)。
                6. 要删除网站推荐，直接删除对应的 <a ... </a> 块即可。
            -->
            <div class="card-grid">
                <!-- 推荐网站 1 -->
                <a href="https://vip1280.net/" target="_blank" rel="noopener noreferrer" class="movie-card">
                    <div class="movie-card-image"><i class="fas fa-film"></i></div>
                    <div class="movie-card-content">
                        <h3 class="movie-card-title">影视站 1</h3>
                        <span class="movie-card-link">vip1280.net</span>
                    </div>
                </a>
                <!-- 推荐网站 2 -->
                <a href="https://wniutv.com/" target="_blank" rel="noopener noreferrer" class="movie-card">
                    <div class="movie-card-image"><i class="fas fa-video"></i></div>
                    <div class="movie-card-content">
                        <h3 class="movie-card-title">影视站 2</h3>
                        <span class="movie-card-link">wniutv.com</span>
                    </div>
                </a>
                <!-- 推荐网站 3 -->
                <a href="https://www.hainatv.net/" target="_blank" rel="noopener noreferrer" class="movie-card">
                     <div class="movie-card-image"><i class="fas fa-desktop"></i></div>
                    <div class="movie-card-content">
                        <h3 class="movie-card-title">影视站 3</h3>
                        <span class="movie-card-link">hainatv.net</span>
                    </div>
                </a>
                <!-- 推荐网站 4 -->
                <a href="https://www.yfsp.lv/" target="_blank" rel="noopener noreferrer" class="movie-card">
                     <div class="movie-card-image"><i class="fas fa-compact-disc"></i></div>
                    <div class="movie-card-content">
                        <h3 class="movie-card-title">影视站 4 [推荐]</h3>
                        <span class="movie-card-link">yfsp.lv</span>
                    </div>
                </a>
                <!-- 在这里添加新的推荐网站卡片 -->
                <!-- 推荐网站 5 -->
                <a href="https://www.fsyuyou.com/" target="_blank" rel="noopener noreferrer" class="movie-card">
                    <div class="movie-card-image"><i class="fas fa-play"></i></div>
                    <div class="movie-card-content">
                        <h3 class="movie-card-title">影视站 5 [推荐]</h3>
                        <span class="movie-card-link">fsyuyou.com</span>
                    </div>
                </a>
                <!-- 推荐网站 6 -->
                <a href="https://www.luhuitang.com/" target="_blank" rel="noopener noreferrer" class="movie-card">
                    <div class="movie-card-image"><i class="fas fa-ticket-alt"></i></div>
                    <div class="movie-card-content">
                        <h3 class="movie-card-title">影视站 6</h3>
                        <span class="movie-card-link">luhuitang.com</span>
                    </div>
                </a>
                <!-- 推荐网站 7 -->
                <a href="https://www.yingshidaquantv.com/" target="_blank" rel="noopener noreferrer" class="movie-card">
                    <div class="movie-card-image"><i class="fas fa-photo-video"></i></div>
                    <div class="movie-card-content">
                        <h3 class="movie-card-title">影视站 7 [推荐]</h3>
                        <span class="movie-card-link">yingshidaquantv.com</span>
                    </div>
                </a>
                <!-- 推荐网站 8 -->
                <a href="https://www.yhdm.mom/" target="_blank" rel="noopener noreferrer" class="movie-card">
                    <div class="movie-card-image"><i class="fas fa-star"></i></div>
                    <div class="movie-card-content">
                        <h3 class="movie-card-title">影视站 8 [推荐]</h3>
                        <span class="movie-card-link">yhdm.mom</span>
                    </div>
                </a>
            </div>
        </section>

        <!-- 页脚样式已更新 -->
        <footer>
            <p>免责声明：本站仅提供视频解析技术学习与演示，不存储任何视频资源。所有解析结果均来自第三方接口，本站不对其内容和可用性负责。请勿将本站用于任何商业或非法用途，否则后果自负。</p>
            <p>&copy; 2024 ZXY视频网站. All Rights Reserved.</p>
        </footer>
    </main>

<script>
// JavaScript 部分保持不变，仅在 <select> 和 <option> 中添加了推荐/备用标记文本，并调整了移动端提示文本
(function() {
    'use strict';

    // --- Configuration ---
    const isMobile = /Mobi|Android/i.test(navigator.userAgent);
    const interfaceTestTimeout = 6000; // Timeout for interface testing (ms)
    // 从 HTML 的 <option> 标签中获取标记为 data-restricted-mobile="true" 的接口 value
    const restrictedMobileInterfaces = Array.from(document.querySelectorAll('#parserInterface option[data-restricted-mobile="true"]'))
                                           .map(option => option.value);
    // Mark interfaces known to sometimes require loading the URL twice
    // !! 请根据实际测试情况调整这个列表 !!
    const doubleParseInterfaces = [
        // "https://jx.xmflv.com/?url=", // 示例，如果需要双重加载则取消注释
        // "https://jx.xmflv.cc/?url=", // 示例
        // "https://www.yemu.xyz/?url=", // 示例
    ];
    // 设置一个在移动端相对安全的默认接口 (确保这个 value 在 <select> 中存在)
    const defaultMobileInterface = "https://bd.jx.cn/?url="; // 示例，请根据实际情况选择

    // --- DOM Elements ---
    const interfaceSelect = document.getElementById('parserInterface');
    const videoUrlInput = document.getElementById('videoUrl');
    const parseButton = document.getElementById('parseButton');
    const autoTestButton = document.getElementById('autoTestButton');
    const videoContainer = document.getElementById('videoContainer');
    const videoPlayer = document.getElementById('videoPlayer');
    const loadingMessage = document.getElementById('loadingMessage');
    const testingMessage = document.getElementById('testingInterfaceMessage');
    const successMessage = document.getElementById('successMessage');
    const errorMessage = document.getElementById('errorMessage');
    const errorText = document.getElementById('errorText');

    // --- Core Parsing Logic ---
    let currentParseTimeout = null; // Timeout ID for iframe loading

    /**
     * Loads URL into iframe, handling timeout and errors.
     * @param {string} interfaceUrl - Base URL of the parsing interface.
     * @param {string} videoUrl - Full URL of the video to parse.
     * @returns {Promise<void>} Resolves on successful load, rejects on error/timeout.
     */
    function _loadVideoInIframe(interfaceUrl, videoUrl) {
        return new Promise((resolve, reject) => {
            clearTimeout(currentParseTimeout);
            const parsedUrl = interfaceUrl + encodeURIComponent(videoUrl);
            console.log(`Attempting to load: ${parsedUrl}`);
            videoPlayer.src = 'about:blank'; // Clear previous content

            setTimeout(() => { videoPlayer.src = parsedUrl; }, 50); // Slight delay

            videoContainer.style.display = 'block'; // Show container early

            let resolved = false; // Flag to prevent double resolution/rejection
            const timeoutId = setTimeout(() => {
                if (resolved) return;
                resolved = true;
                console.warn(`Iframe timeout for ${parsedUrl}`);
                removeListeners();
                videoPlayer.src = 'about:blank';
                reject(new Error(`解析超时 (${interfaceTestTimeout / 1000}秒)，请尝试其他接口。`));
            }, interfaceTestTimeout);

            currentParseTimeout = timeoutId; // Store timeout ID globally for potential clearing

            const onLoad = () => {
                if (resolved) return;
                // Sometimes 'load' fires even on failure (e.g., blocked frame), add a small check
                try {
                    // Accessing contentDocument might fail for cross-origin iframes that didn't load properly
                     if (videoPlayer.contentDocument && videoPlayer.contentDocument.readyState === 'complete') {
                          console.log(`Iframe loaded successfully: ${parsedUrl}`);
                     } else if (videoPlayer.contentWindow && videoPlayer.contentWindow.length > 0) {
                         // If it has some content window elements, might be okay
                         console.log(`Iframe loaded (basic check passed): ${parsedUrl}`);
                     }
                     else {
                         // If contentDocument access fails or readyState isn't complete, it might still be loading or blocked
                         console.log(`Iframe 'load' event fired, but content seems inaccessible or not ready: ${parsedUrl}`);
                         // We might still resolve here, relying on the timeout for definite failures
                     }
                } catch (e) {
                    console.warn(`Iframe 'load' event fired but content access failed (likely cross-origin block on failure): ${parsedUrl}`, e);
                    // Resolve anyway, let the user see if it works. Timeout handles catastrophic failures.
                }
                 resolved = true;
                 clearTimeout(timeoutId);
                 removeListeners();
                 resolve();
            };

            const onError = (event) => {
                if (resolved) return;
                resolved = true;
                console.error(`Iframe error for ${parsedUrl}:`, event);
                clearTimeout(timeoutId);
                removeListeners();
                reject(new Error('解析接口加载失败，可能是接口失效或网络问题。'));
            };

            const removeListeners = () => {
                videoPlayer.removeEventListener('load', onLoad);
                videoPlayer.removeEventListener('error', onError);
            };

            videoPlayer.addEventListener('load', onLoad);
            videoPlayer.addEventListener('error', onError);
        });
    }


    /**
     * Main function to parse the video using a selected interface.
     * @param {string} interfaceUrl - The selected parsing interface URL.
     * @returns {Promise<void>} Resolves if parsing initiates successfully. Rejects on failure.
     */
    async function parseVideo(interfaceUrl) {
        const videoUrl = videoUrlInput.value.trim();
        hideAllStatusMessages();

        if (!videoUrl) {
            showError('请输入有效的视频链接！');
            return Promise.reject(new Error('No video URL'));
        }

        let fullUrl = videoUrl;
        if (!videoUrl.startsWith('http://') && !videoUrl.startsWith('https://')) {
            fullUrl = `https://${videoUrl}`; // Simple protocol prepending
            console.log(`Prepended https:// to URL: ${fullUrl}`);
        }

        disableButtons(true);
        showLoading();

        try {
            // Double parsing logic (if needed for specific interfaces)
            if (doubleParseInterfaces.includes(interfaceUrl)) {
                console.log(`Using double parse for interface: ${interfaceUrl}`);
                try {
                    await _loadVideoInIframe(interfaceUrl, fullUrl);
                    // Optional delay: await new Promise(resolve => setTimeout(resolve, 300));
                    console.log("First parse attempt finished, starting second...");
                    await _loadVideoInIframe(interfaceUrl, fullUrl);
                    console.log("Second parse attempt finished.");
                } catch (doubleParseError) {
                    console.error("Error during double parse:", doubleParseError);
                    throw doubleParseError; // Re-throw to be caught below
                }
            } else {
                console.log(`Using single parse for interface: ${interfaceUrl}`);
                await _loadVideoInIframe(interfaceUrl, fullUrl);
            }

            hideLoading();
            // Success is implied by video container showing and loading message hiding
            // Scroll to video player after successful parsing
             videoContainer.scrollIntoView({ behavior: 'smooth', block: 'center' });
            disableButtons(false);
            return Promise.resolve(); // Indicate success initiation

        } catch (err) {
            console.error('Parsing failed:', err);
            showError(err.message || '解析视频时发生未知错误。');
            hideLoading();
            videoContainer.style.display = 'none'; // Hide container on definite error
            videoPlayer.src = 'about:blank';
            disableButtons(false);
            return Promise.reject(err); // Propagate rejection
        }
    }


    /**
     * Automatically tests available interfaces to find one that works.
     */
    async function autoTestInterfaces() {
        const videoUrl = videoUrlInput.value.trim();
        if (!videoUrl) {
            showError('请先输入视频链接再进行测试！');
            return;
        }

        hideAllStatusMessages();
        showTestingInterface();
        disableButtons(true);

        // Get all options, filter out restricted ones if on mobile
        const options = Array.from(interfaceSelect.options);
        const interfacesToTest = options
            .filter(option => !(isMobile && restrictedMobileInterfaces.includes(option.value)))
            .map(option => ({ value: option.value, text: option.text }));

         if (interfacesToTest.length === 0) {
            showError('当前设备没有可用的自动测试接口。');
            hideTestingInterface();
            disableButtons(false);
            return;
        }

        console.log("Starting auto-test with interfaces:", interfacesToTest.map(i => i.text));
        let bestInterface = null;

        for (const iface of interfacesToTest) {
            console.log(`Testing interface: ${iface.text} (${iface.value})`);
            testingMessage.innerHTML = `<i class="fas fa-vial fa-fw"></i> 正在测试接口: ${iface.text}...`; // Update testing message

            try {
                // Use parseVideo which includes timeout and error handling
                // We need to provide a valid URL for testing, even if it's just the base
                await parseVideo(iface.value); // parseVideo now returns a promise
                // If parseVideo resolves without error, consider it successful for auto-test
                bestInterface = iface.value;
                console.log(`Interface ${iface.text} succeeded.`);
                break; // Stop testing on the first success
            } catch (error) {
                console.warn(`Interface ${iface.text} failed: ${error.message}`);
                // Hide video container immediately if this test fails
                videoContainer.style.display = 'none';
                videoPlayer.src = 'about:blank';
                // Continue to the next interface
            }
        }

        hideTestingInterface(); // Hide the "testing..." message

        if (bestInterface) {
            interfaceSelect.value = bestInterface;
            showSuccessMessage(); // Show success confirmation
            // The successful parseVideo call would have already displayed the video
            // Ensure the video remains visible and scroll to it
            videoContainer.style.display = 'block';
            videoContainer.scrollIntoView({ behavior: 'smooth', block: 'center' });
            // Need to ensure buttons are enabled AFTER success message shows
             disableButtons(false);
        } else {
            showError('所有可用接口测试失败，请检查链接或手动选择接口尝试。');
            videoContainer.style.display = 'none'; // Ensure container is hidden if all fail
            videoPlayer.src = 'about:blank';
             disableButtons(false); // Re-enable buttons on failure too
        }
    }

    // --- UI Helper Functions ---
    function showLoading() { hideAllStatusMessages(); loadingMessage.style.display = 'flex'; } // Changed to flex
    function hideLoading() { loadingMessage.style.display = 'none'; }
    function showTestingInterface() { hideAllStatusMessages(); testingMessage.style.display = 'flex'; testingMessage.innerHTML = '<i class="fas fa-vial fa-fw"></i> 正在自动测试接口...'; } // Changed to flex
    function hideTestingInterface() { testingMessage.style.display = 'none'; }

    function showSuccessMessage() {
        hideAllStatusMessages();
        successMessage.style.display = 'flex'; // Changed to flex
        setTimeout(() => { if (successMessage.style.display === 'flex') successMessage.style.display = 'none'; }, 3500);
    }

    function showError(message) {
        hideAllStatusMessages();
        errorText.textContent = message;
        errorMessage.style.display = 'flex'; // Changed to flex
        // Keep error message visible longer
        setTimeout(() => { if (errorMessage.style.display === 'flex') errorMessage.style.display = 'none'; }, 7000);
    }

    function hideAllStatusMessages() {
        loadingMessage.style.display = 'none';
        testingMessage.style.display = 'none';
        successMessage.style.display = 'none';
        errorMessage.style.display = 'none';
    }

    function disableButtons(disabled) {
        parseButton.disabled = disabled;
        autoTestButton.disabled = disabled;
    }

    /**
     * Handles mobile confirmation logic.
     * @param {string} selectedValue - Value of the selected interface.
     * @returns {boolean} True if parsing should proceed, false otherwise.
     */
    function checkMobileRestriction(selectedValue) {
        if (isMobile && restrictedMobileInterfaces.includes(selectedValue)) {
            const selectedOption = interfaceSelect.options[interfaceSelect.selectedIndex];
            // Extract text before the mobile icon if it exists
            const optionText = selectedOption ? selectedOption.text.replace(/\s*<span class="mobile-indicator">.*?<\/span>/i, '').replace(/\s*📱.*/, '').trim() : '该接口';
            const confirmMessage = `您当前使用的是移动设备，选择的 "${optionText}" 可能包含不适合手机浏览的内容或广告较多。\n\n确定要继续使用吗？`;
            if (!confirm(confirmMessage)) {
                // Optionally reset to default if user cancels
                // if (Array.from(interfaceSelect.options).some(opt => opt.value === defaultMobileInterface)) {
                //     interfaceSelect.value = defaultMobileInterface;
                //     updateMobileIndicator(); // Update indicator if selection changed
                // }
                return false; // Do not proceed
            }
        }
        return true; // Proceed
    }

    // Function to add/remove mobile indicator icon dynamically (if needed)
    function updateMobileIndicator() {
        Array.from(interfaceSelect.options).forEach(option => {
            const mobileIndicatorClass = 'mobile-indicator-text'; // Use a class for easier selection/removal
            // Remove existing text indicator first
            option.textContent = option.textContent.replace(` ${String.fromCodePoint(0x1F4F5)}`, '').trim();
            option.classList.remove('restricted-mobile'); // Reset class

            if (isMobile && restrictedMobileInterfaces.includes(option.value)) {
                option.classList.add('restricted-mobile');
                // Add Unicode character back if not already present
                if (!option.textContent.includes(String.fromCodePoint(0x1F4F5))) {
                    option.textContent += ` ${String.fromCodePoint(0x1F4F5)}`; // Add mobile phone with arrow emoji
                }
            }
        });
    }


    // --- Event Listeners ---
    function initEventListeners() {
        parseButton.addEventListener('click', () => {
            const selectedInterface = interfaceSelect.value;
            if (checkMobileRestriction(selectedInterface)) {
                 parseVideo(selectedInterface).catch(err => {
                    // Error already handled visually in parseVideo
                    console.log("Parse button click resulted in error (handled).");
                 });
            } else {
                console.log("Mobile restriction cancelled by user.");
                 // Ensure buttons are re-enabled if confirm is cancelled
                 disableButtons(false);
            }
        });

        autoTestButton.addEventListener('click', autoTestInterfaces);

        // Update mobile indicator on select change
        interfaceSelect.addEventListener('change', updateMobileIndicator);

        videoUrlInput.focus(); // Auto-focus URL input on load
    }

    // --- Initialization ---
    document.addEventListener('DOMContentLoaded', () => {
        // Apply mobile specific UI adjustments on load
        updateMobileIndicator();

        // Set a safer default interface on mobile if the current default is restricted
        if (isMobile && restrictedMobileInterfaces.includes(interfaceSelect.value)) {
             // Check if defaultMobileInterface exists before setting it
             if (Array.from(interfaceSelect.options).some(opt => opt.value === defaultMobileInterface)) {
                interfaceSelect.value = defaultMobileInterface;
                updateMobileIndicator(); // Update indicators after changing default
             }
        }

        initEventListeners();
        console.log("ZXY Video Parser Initialized. Mobile:", isMobile);
        console.log("Restricted Mobile Interfaces:", restrictedMobileInterfaces);
    });

})();
</script>

</body>
</html>
