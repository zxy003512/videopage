<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZXYè§†é¢‘ç½‘ç«™ - åœ¨çº¿è§†é¢‘è§£æ</title>
    <meta name="description" content="ZXYè§†é¢‘ç½‘ç«™æä¾›ç®€æ´é«˜æ•ˆçš„åœ¨çº¿è§†é¢‘è§£æå·¥å…·ï¼Œæ”¯æŒä¸»æµè§†é¢‘å¹³å°ã€‚">
    <meta name="keywords" content="ZXYè§†é¢‘, è§†é¢‘è§£æ, åœ¨çº¿è§£æ, VIPè§†é¢‘è§£æ, å…å¹¿å‘Šçœ‹è§†é¢‘">
    <!-- Preload Fonts and Icons for performance -->
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" as="style" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" as="style">

    <!-- Fonts and Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        /* --- CSS Reset & Base Styles --- */
        *,
        *::before,
        *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        :root {
            /* == å…¨æ–°è‰²å½©æ–¹æ¡ˆ == */
            --primary-gradient: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%); /* ä¸»æ¸å˜è‰² (ç´« -> è“) */
            --primary-color-start: #6a11cb; /* æ¸å˜èµ·å§‹è‰² */
            --primary-color-end: #2575fc; /* æ¸å˜ç»“æŸè‰² */
            --accent-color: #34e89e; /* å¼ºè°ƒè‰² (äº®é’ç»¿) */
            --accent-hover: #2bc48a;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --danger-hover: #c82333;
            --success-color: #28a745; /* ä¿ç•™ï¼Œæˆ–ä½¿ç”¨ accent-color */

            /* == èƒŒæ™¯ä¸æ–‡æœ¬è‰² == */
            --body-bg: linear-gradient(to top, #f3e7e9 0%, #e3eeff 100%); /* æŸ”å’Œæ¸å˜èƒŒæ™¯ (ç²‰ -> è“) */
            --container-bg: rgba(255, 255, 255, 0.95); /* å®¹å™¨èƒŒæ™¯ï¼Œè½»å¾®é€æ˜ */
            --card-bg: #ffffff; /* å¡ç‰‡èƒŒæ™¯ */
            --text-color: #333; /* æ·±ç°è‰²æ–‡æœ¬ */
            --text-light: #667; /* æµ…ç°è‰²æ–‡æœ¬ */
            --border-color: rgba(0, 0, 0, 0.08); /* æ›´æŸ”å’Œçš„è¾¹æ¡†è‰² */

            /* == é˜´å½±ä¸åœ†è§’ == */
            --shadow-light: rgba(0, 0, 0, 0.06);
            --shadow-medium: rgba(0, 0, 0, 0.1);
            --shadow-strong: rgba(50, 50, 93, 0.15); /* æ›´è‡ªç„¶çš„é˜´å½± */
            --border-radius-sm: 8px;
            --border-radius-md: 16px; /* æ›´å¤§çš„åœ†è§’ */
            --border-radius-lg: 24px;

            /* == åŠ¨ç”»ä¸è¿‡æ¸¡ == */
            --animation-speed: 0.3s;
            --transition-smooth: all var(--animation-speed) cubic-bezier(0.25, 0.8, 0.25, 1); /* å¹³æ»‘è¿‡æ¸¡ */

            /* ç§»åŠ¨ç«¯é™åˆ¶æ¥å£æç¤º */
            --restricted-interface-bg: rgba(255, 193, 7, 0.1);
            --restricted-interface-color: #b98900;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Poppins', sans-serif;
            color: var(--text-color);
            /* == åº”ç”¨æ¸å˜èƒŒæ™¯ == */
            background: var(--body-bg);
            background-attachment: fixed; /* å›ºå®šèƒŒæ™¯ */
            line-height: 1.7; /* å¢åŠ è¡Œé«˜ */
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 3rem 1rem; /* å¢åŠ ä¸Šä¸‹å†…è¾¹è· */
            overflow-x: hidden;
        }

        /* --- ä¸»å®¹å™¨ --- */
        .container {
            width: 100%;
            max-width: 950px; /* ç¨å¾®åŠ å®½ */
            background-color: var(--container-bg);
            padding: 3rem 3.5rem; /* å¢åŠ å†…è¾¹è· */
            border-radius: var(--border-radius-lg); /* å¤§åœ†è§’ */
            /* == ç²¾è‡´é˜´å½± == */
            box-shadow: 0 15px 35px var(--shadow-strong), 0 5px 15px rgba(0,0,0,0.07);
            backdrop-filter: blur(5px); /* è½»å¾®æ¨¡ç³ŠèƒŒæ™¯ (å¦‚æœæµè§ˆå™¨æ”¯æŒ) */
            border: 1px solid rgba(255, 255, 255, 0.2); /* ç»†å¾®è¾¹æ¡†å¢åŠ è´¨æ„Ÿ */
            animation: fadeInScale 0.8s ease-out forwards;
            opacity: 0;
            transform: scale(0.97); /* åˆå§‹ç¨å¾®ç¼©å° */
        }

        @keyframes fadeInScale {
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* --- æ’ç‰ˆ --- */
        h1 {
            /* == æ¸å˜æ–‡å­—æ ‡é¢˜ == */
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            filter: drop-shadow(0 2px 3px rgba(0,0,0,0.1)); /* æ–‡å­—è½»å¾®é˜´å½± */

            text-align: center;
            margin-bottom: 2.5rem; /* å¢åŠ  H1 ä¸‹æ–¹é—´è· */
            font-weight: 700; /* åŠ ç²— */
            font-size: 2.5rem; /* å¢å¤§å­—å· */
            letter-spacing: -1px; /* è°ƒæ•´å­—é—´è· */
        }
        h1 i { margin-right: 0.8rem; /* å›¾æ ‡ä¸æ–‡å­—é—´è· */ }

        h2 {
            color: var(--primary-color-start); /* ä½¿ç”¨æ¸å˜èµ·å§‹è‰² */
            margin-top: 3rem; /* å¢åŠ  H2 ä¸Šæ–¹é—´è· */
            margin-bottom: 1.5rem;
            font-weight: 600;
            padding-bottom: 0.8rem;
            border-bottom: 2px solid var(--border-color);
            display: flex; /* è®©å›¾æ ‡å’Œæ–‡å­—å¯¹é½ */
            align-items: center;
            gap: 0.6rem; /* å›¾æ ‡å’Œæ–‡å­—é—´è· */
        }

        p {
            margin-bottom: 1.2rem;
            color: var(--text-light);
        }

        strong {
            color: var(--text-color);
            font-weight: 600; /* åŠ å¼º strong æ•ˆæœ */
        }

        /* --- æŒ‰é’® --- */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.6rem;
            padding: 0.85rem 1.8rem; /* è°ƒæ•´æŒ‰é’®å¤§å° */
            font-size: 1rem;
            font-weight: 500;
            color: #fff;
            /* == æ¸å˜èƒŒæ™¯æŒ‰é’® == */
            background: var(--primary-gradient);
            border: none;
            border-radius: var(--border-radius-md); /* ä¸­ç­‰åœ†è§’ */
            cursor: pointer;
            transition: var(--transition-smooth);
            text-decoration: none;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
            z-index: 1;
        }

        .btn:hover {
            /* == æ‚¬åœæ•ˆæœï¼šæå‡ã€é˜´å½±åŠ æ·±ã€è½»å¾®å˜äº® == */
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            filter: brightness(1.1);
        }

        .btn:active {
            transform: translateY(-1px) scale(0.98);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            filter: brightness(0.95);
        }

        .btn:disabled {
            background: #adb5bd;
            cursor: not-allowed;
            box-shadow: none;
            transform: none;
            filter: none;
            opacity: 0.65;
        }

        /* æŒ‰é’®æ¶Ÿæ¼ªæ•ˆæœ (ä¿æŒ) */
        .btn::after { /* ... çœç•¥å·²æœ‰ä»£ç  ... */ }
        .btn:focus:not(:active)::after { /* ... çœç•¥å·²æœ‰ä»£ç  ... */ }
        @keyframes ripple { /* ... çœç•¥å·²æœ‰ä»£ç  ... */ }

        .platform-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 1.2rem; /* å¢åŠ æŒ‰é’®é—´è· */
            justify-content: center;
            margin-bottom: 3rem; /* å¢åŠ ä¸‹æ–¹é—´è· */
        }

        .platform-btn {
            flex-grow: 1;
            min-width: 130px; /* ç¨å¾®å¢å¤§æœ€å°å®½åº¦ */
            /* å¯ä»¥ç»™å¹³å°æŒ‰é’®ä¸åŒçš„é¢œè‰²æˆ–æ ·å¼ï¼Œä½†å½“å‰ä¿æŒç»Ÿä¸€ */
        }

        /* ç‰¹åˆ«çªå‡ºâ€œè‡ªåŠ¨æµ‹è¯•â€å’Œâ€œç«‹å³è§£æâ€æŒ‰é’® */
        #autoTestButton {
            background: linear-gradient(135deg, var(--accent-color) 0%, var(--accent-hover) 100%);
        }
        #parseButton {
            /* ä½¿ç”¨ä¸»æ¸å˜è‰²ï¼Œå·²é»˜è®¤ */
        }


        /* --- è¡¨å•å…ƒç´  --- */
        .parser-form {
            display: grid;
            gap: 1.5rem; /* å¢åŠ è¡¨å•å…ƒç´ é—´è· */
            margin-bottom: 2.5rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-label {
            margin-bottom: 0.7rem; /* å¢åŠ æ ‡ç­¾å’Œè¾“å…¥æ¡†é—´è· */
            font-weight: 500;
            color: var(--primary-color-start); /* æ ‡ç­¾é¢œè‰² */
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .form-label i { color: var(--primary-color-end); }

        .form-control {
            width: 100%;
            padding: 0.9rem 1.2rem; /* å¢åŠ å†…è¾¹è· */
            background-color: #fff;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-md); /* ä¸­ç­‰åœ†è§’ */
            color: var(--text-color);
            font-size: 1rem;
            font-family: inherit;
            transition: border-color var(--animation-speed) ease, box-shadow var(--animation-speed) ease;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.05); /* è½»å¾®å†…é˜´å½± */
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-color-end);
            /* == æ›´æŸ”å’Œçš„å‘å…‰æ•ˆæœ == */
            box-shadow: 0 0 0 4px rgba(37, 117, 252, 0.15), inset 0 1px 3px rgba(0,0,0,0.05);
        }

        select.form-control {
            appearance: none;
            /* == è‡ªå®šä¹‰ä¸‹æ‹‰ç®­å¤´ (SVG) == */
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="%236a11cb"><path fill-rule="evenodd" d="M4.646 5.646a.5.5 0 0 1 .708 0L8 8.293l2.646-2.647a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 0 1 0-.708z"/></svg>');
            background-repeat: no-repeat;
            background-position: right 1.2rem center;
            background-size: 1.2em; /* å¢å¤§ç®­å¤´ */
            padding-right: 3.5rem; /* ä¸ºç®­å¤´ç•™å‡ºç©ºé—´ */
        }

        .form-control option.restricted-mobile {
            background-color: var(--restricted-interface-bg);
            color: var(--restricted-interface-color);
            font-style: italic;
        }
        /* ç»™ select ä¸‹æ‹‰é€‰é¡¹å¢åŠ ä¸€ç‚¹ padding */
        .form-control option {
            padding: 5px 10px;
        }

        .parser-actions {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-top: 0.5rem; /* å¾®è°ƒä¸Šæ–¹é—´è· */
        }

        .parser-actions .btn {
            flex-grow: 1;
        }

        /* --- è¯´æ˜æ¡† --- */
        .instructions {
            /* == æ›´èå…¥ä¸»é¢˜çš„æ ·å¼ == */
            background-color: rgba(230, 240, 255, 0.5); /* æ·¡è“è‰²åŠé€æ˜ */
            border-left: 6px solid var(--primary-color-end); /* è“è‰²è¾¹æ¡† */
            padding: 1.8rem 2rem; /* å¢åŠ å†…è¾¹è· */
            margin-bottom: 3rem;
            border-radius: var(--border-radius-md); /* ä¸­åœ†è§’ */
            font-size: 0.98rem; /* å¾®è°ƒå­—å· */
            box-shadow: 0 4px 10px var(--shadow-light);
        }
        .instructions p:last-child { margin-bottom: 0; }
        .instructions strong { color: var(--primary-color-start); font-weight: 600; }
        .instructions strong i { color: var(--primary-color-end); }
        .instructions ol { padding-left: 1.8rem; margin-bottom: 1.2rem; list-style-type: decimal-leading-zero; }
        .instructions li { margin-bottom: 0.5rem; }


        /* --- è§†é¢‘æ’­æ”¾å™¨ --- */
        .video-container {
            position: relative;
            width: 100%;
            padding-bottom: 56.25%; /* 16:9 */
            border-radius: var(--border-radius-md); /* ä¸­åœ†è§’ */
            overflow: hidden;
            background-color: #111; /* æ·±è‰²èƒŒæ™¯ */
            margin-top: 2.5rem; /* å¢åŠ ä¸Šæ–¹é—´è· */
            display: none;
            box-shadow: 0 10px 30px var(--shadow-medium); /* æ›´æ˜æ˜¾çš„é˜´å½± */
            animation: fadeIn 0.6s ease;
        }

        .video-iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }

        /* --- çŠ¶æ€æ¶ˆæ¯ --- */
        .status-message {
            text-align: center;
            padding: 1rem 1.5rem; /* å¢åŠ å†…è¾¹è· */
            border-radius: var(--border-radius-md);
            margin-top: 2rem; /* å¢åŠ ä¸Šæ–¹é—´è· */
            display: none;
            font-weight: 500;
            animation: slideDown 0.4s ease-out;
            border: 1px solid transparent;
            box-shadow: 0 3px 8px var(--shadow-light);
            display: flex; /* ä½¿ç”¨ flex å¸ƒå±€è®©å›¾æ ‡å’Œæ–‡å­—æ›´å¥½å¯¹é½ */
            align-items: center;
            justify-content: center;
            gap: 0.8rem; /* å›¾æ ‡å’Œæ–‡å­—é—´è· */
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .status-loading,
        .status-testing {
            background-color: rgba(255, 193, 7, 0.15); /* åŠ æ·±ä¸€ç‚¹èƒŒæ™¯ */
            color: #a37b00; /* æ›´æ·±çš„é»„è‰² */
            border-color: rgba(255, 193, 7, 0.4);
        }
        .status-error {
            background-color: rgba(220, 53, 69, 0.1);
            color: var(--danger-color);
            border-color: rgba(220, 53, 69, 0.4);
        }
        .status-success {
            background-color: rgba(40, 167, 69, 0.1);
            color: var(--success-color);
            border-color: rgba(40, 167, 69, 0.4);
        }

        /* --- ç”µå½±ç«™ç‚¹å¡ç‰‡ --- */
        .movie-sites {
            margin-top: 3.5rem; /* å¢åŠ ä¸Šæ–¹é—´è· */
        }

        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); /* å¢å¤§æœ€å°å®½åº¦ */
            gap: 2rem; /* å¢åŠ å¡ç‰‡é—´è· */
            margin-top: 2rem; /* å¢åŠ ä¸Šæ–¹é—´è· */
        }

        .movie-card {
            background-color: var(--card-bg);
            border-radius: var(--border-radius-md);
            overflow: hidden;
            box-shadow: 0 8px 20px var(--shadow-light); /* åˆå§‹è¾ƒæŸ”å’Œé˜´å½± */
            transition: var(--transition-smooth);
            text-decoration: none;
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            border: 1px solid var(--border-color);
        }

        .movie-card:hover {
            /* == å¢å¼ºæ‚¬åœæ•ˆæœ == */
            transform: translateY(-8px) scale(1.03);
            box-shadow: 0 15px 35px var(--shadow-medium);
            border-color: var(--primary-color-end); /* æ‚¬åœæ—¶è¾¹æ¡†å˜è‰² */
        }

        .movie-card-image {
            height: 140px; /* å¢åŠ å›¾ç‰‡åŒºåŸŸé«˜åº¦ */
            /* == æ›´å¸å¼•äººçš„æ¸å˜èƒŒæ™¯ == */
            background: linear-gradient(135deg, #f6d365 0%, #fda085 100%); /* é»„ -> æ©™ */
            display: flex;
            align-items: center;
            justify-content: center;
            color: rgba(255, 255, 255, 0.8); /* ç™½è‰²å›¾æ ‡ï¼Œå¸¦é€æ˜åº¦ */
            font-size: 3.5rem; /* å¢å¤§å›¾æ ‡ */
            transition: var(--transition-smooth);
        }
        .movie-card:hover .movie-card-image {
             background: linear-gradient(135deg, #fda085 0%, #f6d365 100%); /* æ‚¬åœæ—¶åè½¬æ¸å˜ */
             color: #fff; /* æ‚¬åœæ—¶å›¾æ ‡æ›´äº® */
        }

        .movie-card-content {
            padding: 1.2rem; /* å¢åŠ å†…å®¹åŒºå†…è¾¹è· */
            text-align: center;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .movie-card-title {
            font-weight: 600;
            margin-bottom: 0.4rem;
            font-size: 1.15rem; /* å¢å¤§æ ‡é¢˜å­—å· */
            color: var(--primary-color-start); /* æ ‡é¢˜é¢œè‰² */
            transition: color var(--animation-speed) ease;
        }
        .movie-card:hover .movie-card-title {
            color: var(--primary-color-end);
        }

        .movie-card-link {
            font-size: 0.88rem; /* å¾®è°ƒé“¾æ¥å­—å· */
            color: var(--text-light);
            word-break: break-all;
        }

        .movie-warning {
            margin-top: 1.5rem; /* å¢åŠ ä¸Šæ–¹é—´è· */
            padding: 1.2rem; /* å¢åŠ å†…è¾¹è· */
            background-color: rgba(255, 193, 7, 0.1);
            color: #b98900;
            border: 1px solid rgba(255, 193, 7, 0.3);
            border-radius: var(--border-radius-md);
            font-size: 0.95rem; /* å¾®è°ƒå­—å· */
            text-align: center;
            display: flex; /* å›¾æ ‡å’Œæ–‡å­—å¯¹é½ */
            align-items: center;
            justify-content: center;
            gap: 0.6rem;
            box-shadow: 0 3px 8px var(--shadow-light);
        }
        .movie-warning i { font-size: 1.1rem; }

        /* --- é¡µè„š --- */
        footer {
            text-align: center;
            margin-top: 4rem; /* å¢åŠ ä¸Šæ–¹é—´è· */
            padding-top: 2rem;
            border-top: 1px solid var(--border-color);
            font-size: 0.9em;
            color: var(--text-light);
            opacity: 0.8; /* è®©é¡µè„šä¸é‚£ä¹ˆæ˜¾çœ¼ */
        }
        footer p { margin-bottom: 0.5rem; } /* å‡å°é¡µè„šæ®µè½é—´è· */

        /* --- å¯è®¿é—®æ€§ --- */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        /* --- å“åº”å¼è®¾è®¡ --- */
        @media (max-width: 768px) {
            body { padding: 2rem 0.8rem; }
            .container { padding: 2.5rem 1.5rem; border-radius: var(--border-radius-md); } /* è°ƒæ•´å®¹å™¨å†…è¾¹è·å’Œåœ†è§’ */
            h1 { font-size: 2rem; } /* è°ƒæ•´æ ‡é¢˜å¤§å° */
            .platform-buttons { flex-direction: column; gap: 0.8rem; margin-bottom: 2rem; }
            .platform-btn { width: 100%; padding: 0.8rem 1.5rem; }
            .parser-actions { flex-direction: column; gap: 0.8rem; }
             .parser-actions .btn { width: 100%; padding: 0.8rem 1.5rem; }
            .card-grid { grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 1.2rem; } /* è°ƒæ•´å¡ç‰‡å¸ƒå±€ */
            .movie-card-image { height: 120px; font-size: 3rem; }
            .movie-card-title { font-size: 1.05rem; }
            h2 { font-size: 1.3rem; }
        }

         @media (max-width: 480px) {
             body { padding: 1.5rem 0.5rem; }
             .container { padding: 2rem 1rem; border-radius: var(--border-radius-sm); } /* è¿›ä¸€æ­¥è°ƒæ•´ */
             h1 { font-size: 1.8rem; }
             .btn, .platform-btn, .parser-actions .btn { padding: 0.75rem 1.4rem; font-size: 0.95rem; }
             .form-control { padding: 0.8rem 1rem; font-size: 0.95rem; }
             select.form-control { background-position: right 0.8rem center; padding-right: 3rem; }
             .card-grid { grid-template-columns: 1fr 1fr; gap: 1rem; } /* æ‰‹æœºä¸Šå›ºå®šä¸¤åˆ— */
             .movie-card-image { height: 100px; font-size: 2.5rem; }
             .movie-card-title { font-size: 1rem; }
             .instructions { padding: 1.5rem 1.2rem; font-size: 0.92rem; }
             .movie-warning { padding: 1rem; font-size: 0.9rem; }
             footer { margin-top: 3rem; padding-top: 1.5rem; font-size: 0.85em; }
         }

    </style>
</head>
<body>

    <main class="container">
        <!-- H1 æ ‡é¢˜ç°åœ¨ä½¿ç”¨æ¸å˜æ–‡å­— -->
        <h1><i class="fas fa-film fa-fw"></i> ZXYè§†é¢‘ç½‘ç«™</h1>

        <!-- å¹³å°æŒ‰é’®æ ·å¼å·²æ›´æ–° -->
        <nav class="platform-buttons" aria-label="è§†é¢‘å¹³å°å¯¼èˆª">
            <a href="https://v.qq.com/" target="_blank" rel="noopener noreferrer" class="btn platform-btn" title="è®¿é—®è…¾è®¯è§†é¢‘å®˜ç½‘">
                <i class="fab fa-qq" aria-hidden="true"></i> è…¾è®¯è§†é¢‘
            </a>
            <a href="https://www.iqiyi.com/" target="_blank" rel="noopener noreferrer" class="btn platform-btn" title="è®¿é—®çˆ±å¥‡è‰ºå®˜ç½‘">
                <i class="fas fa-play-circle" aria-hidden="true"></i> çˆ±å¥‡è‰º
            </a>
            <a href="https://www.bilibili.com/" target="_blank" rel="noopener noreferrer" class="btn platform-btn" title="è®¿é—®å“”å“©å“”å“©å®˜ç½‘">
                <i class="fas fa-tv" aria-hidden="true"></i> Bilibili
            </a>
            <!-- ä½ å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ æ›´å¤šå¹³å°æŒ‰é’® -->
        </nav>

        <!-- è¯´æ˜æ¡†æ ·å¼å·²æ›´æ–° -->
        <section class="instructions" aria-labelledby="instructions-heading">
            <h2 id="instructions-heading" class="sr-only">ä½¿ç”¨è¯´æ˜</h2>
            <p><strong><i class="fas fa-info-circle fa-fw"></i> å¦‚ä½•ä½¿ç”¨:</strong></p>
            <ol>
                <li>ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®å‰å¾€è§†é¢‘å¹³å°ï¼Œæˆ–ç›´æ¥æ‰“å¼€è§†é¢‘ç½‘ç«™ã€‚</li>
                <li>æ‰¾åˆ°æƒ³çœ‹çš„è§†é¢‘ï¼Œå¤åˆ¶æµè§ˆå™¨åœ°å€æ ä¸­çš„å®Œæ•´é“¾æ¥ (URL)ã€‚</li>
                <li>è¿”å›æœ¬é¡µé¢ï¼Œå°†é“¾æ¥ç²˜è´´åˆ°ä¸‹æ–¹çš„è¾“å…¥æ¡†ä¸­ã€‚</li>
                <li>é€‰æ‹©ä¸€ä¸ªè§£ææ¥å£ï¼ˆæ¨èç‚¹å‡» <strong style="color: var(--accent-color);">è‡ªåŠ¨æµ‹è¯•</strong>ï¼‰ã€‚</li>
                <li>ç‚¹å‡» <strong style="color: var(--primary-color-end);">ç«‹å³è§£æ</strong> æŒ‰é’®ï¼Œç¨ç­‰ç‰‡åˆ»å³å¯æ’­æ”¾ã€‚</li>
            </ol>
            <p><strong>æ³¨æ„ï¼š</strong> è‹¥æ’­æ”¾å¤±è´¥æˆ–å¡é¡¿ï¼Œè¯·å°è¯•åˆ‡æ¢å…¶ä»–è§£ææ¥å£ã€‚æœ¬å·¥å…·ä»…ä¾›å­¦ä¹ äº¤æµï¼Œè¯·å‹¿ç”¨äºéæ³•ç”¨é€”ã€‚</p>
        </section>

        <!-- è¡¨å•æ ·å¼å·²æ›´æ–° -->
        <section class="parser-form" aria-labelledby="parser-heading">
            <h2 id="parser-heading" class="sr-only">è§†é¢‘è§£æå™¨</h2>
            <div class="form-group">
                <label for="parserInterface" class="form-label"><i class="fas fa-server fa-fw"></i> è§£ææ¥å£:</label>
                <!--
                    ä¿®æ”¹/æ·»åŠ /åˆ é™¤ è§£ææ¥å£:
                    1. å¤åˆ¶ä¸‹é¢çš„ä¸€ä¸ª <option> ... </option> æ ‡ç­¾è¡Œã€‚
                    2. ä¿®æ”¹ value="æ¥å£åœ°å€" ä¸­çš„ "æ¥å£åœ°å€"ï¼Œç¡®ä¿åœ°å€ä»¥ "?url=" æˆ–ç±»ä¼¼çš„å‚æ•°ç»“å°¾ã€‚è¿™æ˜¯å®é™…ä½¿ç”¨çš„æ¥å£é“¾æ¥ã€‚
                    3. ä¿®æ”¹ > å’Œ </option> ä¹‹é—´çš„æ–‡æœ¬ï¼Œè¿™æ˜¯ä¸‹æ‹‰åˆ—è¡¨ä¸­æ˜¾ç¤ºçš„åç§°ã€‚
                    4. (å¯é€‰) å¦‚æœæŸä¸ªæ¥å£åœ¨æ‰‹æœºä¸Šå¯èƒ½æœ‰é—®é¢˜ï¼ˆå¦‚å¹¿å‘Šè¿‡å¤šã€å…¼å®¹æ€§å·®ï¼‰ï¼Œå¯ä»¥æ·»åŠ  data-restricted-mobile="true" å±æ€§ï¼ŒJS ä¼šåœ¨æ‰‹æœºè®¿é—®æ—¶ç»™å‡ºæç¤ºï¼Œå¹¶ä¸”æ ·å¼ä¸­ä¼šæ ‡è®°ã€‚
                    5. è¦åˆ é™¤æ¥å£ï¼Œç›´æ¥åˆ é™¤å¯¹åº”çš„ <option> ... </option> è¡Œå³å¯ã€‚
                    æ³¨æ„ï¼šè¯·ç¡®ä¿æ¥å£åœ°å€æ˜¯çœŸå®æœ‰æ•ˆçš„ï¼ä»¥ä¸‹ä»…ä¸ºç¤ºä¾‹ã€‚
                -->
                <select id="parserInterface" class="form-control" aria-describedby="interface-description">
                    <option value="https://jx.xmflv.com/?url=" data-restricted-mobile="true">æ¥å£ 1 (xmflv.com)</option>
                    <option value="https://bd.jx.cn/?url=">æ¥å£ 2 (bd.jx.cn)</option>
                    <option value="https://jx.xmflv.cc/?url=" data-restricted-mobile="true">æ¥å£ 3 (xmflv.cc)</option>
                    <option value="https://jx.hls.one/?url=">æ¥å£ 4 (hls.one) [æ¨è]</option>
                    <option value="https://jx.77flv.cc/?url=">æ¥å£ 5 (77flv.cc) [æ¨è]</option>
                    <option value="https://www.yemu.xyz/?url=" data-restricted-mobile="true">æ¥å£ 6 (yemu.xyz)</option>
                    <!-- åœ¨è¿™é‡Œæ·»åŠ æ–°çš„æ¥å£ -->
                    <option value="https://yparse.jn1.cc/index.php?url=">æ¥å£ 7 (èšåˆ) [å¤‡ç”¨]</option>
                    <option value="https://player.q168.vip/?url=">æ¥å£ 8 (q168.vip) [å¤‡ç”¨]</option>
                </select>
                <small id="interface-description" class="text-light" style="margin-top: 0.5rem;">å¸¦ <i class="fas fa-mobile-alt fa-fw" style="color: var(--restricted-interface-color);"></i> æ ‡è®°çš„æ¥å£åœ¨æ‰‹æœºç«¯å¯èƒ½ä½“éªŒä¸ä½³ã€‚</small>
            </div>

            <div class="form-group">
                <label for="videoUrl" class="form-label"><i class="fas fa-link fa-fw"></i> è§†é¢‘é“¾æ¥:</label>
                <input type="url" id="videoUrl" class="form-control" placeholder="è¯·åœ¨æ­¤å¤„ç²˜è´´è§†é¢‘æ’­æ”¾é¡µé¢çš„å®Œæ•´é“¾æ¥..." required autocomplete="off">
            </div>

            <!-- è§£ææŒ‰é’®æ ·å¼å·²æ›´æ–° -->
            <div class="parser-actions">
                <button class="btn" type="button" id="autoTestButton" title="è‡ªåŠ¨æµ‹è¯•æŸ¥æ‰¾å¯ç”¨æ¥å£">
                    <i class="fas fa-magic fa-fw" aria-hidden="true"></i> è‡ªåŠ¨æµ‹è¯•
                </button>
                <button class="btn" type="button" id="parseButton" title="ä½¿ç”¨é€‰å®šæ¥å£è§£æè§†é¢‘">
                    <i class="fas fa-play fa-fw" aria-hidden="true"></i> ç«‹å³è§£æ
                </button>
            </div>
        </section>

        <!-- çŠ¶æ€æ¶ˆæ¯æ ·å¼å·²æ›´æ–° -->
        <div class="status-message status-loading" id="loadingMessage" role="status" aria-live="polite"><i class="fas fa-spinner fa-spin fa-fw"></i> è§£æä¸­ï¼Œè¯·ç¨å€™...</div>
        <div class="status-message status-testing" id="testingInterfaceMessage" role="status" aria-live="polite"><i class="fas fa-vial fa-fw"></i> æ­£åœ¨è‡ªåŠ¨æµ‹è¯•æ¥å£...</div>
        <div class="status-message status-success" id="successMessage" role="status" aria-live="polite"><i class="fas fa-check-circle fa-fw"></i> æ¥å£æµ‹è¯•æˆåŠŸï¼Œå·²é€‰æ‹©å¯ç”¨æ¥å£ï¼</div>
        <div class="status-message status-error" id="errorMessage" role="alert" aria-live="assertive"><i class="fas fa-exclamation-triangle fa-fw"></i> <span id="errorText">å‘ç”Ÿé”™è¯¯</span></div>

        <!-- è§†é¢‘æ’­æ”¾å™¨æ ·å¼å·²æ›´æ–° -->
        <div class="video-container" id="videoContainer">
            <iframe class="video-iframe" id="videoPlayer" title="è§†é¢‘æ’­æ”¾å™¨" allow="autoplay; fullscreen" allowfullscreen sandbox="allow-scripts allow-same-origin allow-popups"></iframe>
        </div>

        <!-- å½±è§†ç«™ç‚¹æ¨èå¡ç‰‡æ ·å¼å·²æ›´æ–° -->
        <section class="movie-sites" aria-labelledby="movie-sites-heading">
            <!-- H2 æ ‡é¢˜æ ·å¼å·²æ›´æ–° -->
            <h2 id="movie-sites-heading"><i class="fas fa-tv fa-fw"></i> å…è´¹å½±è§†ç«™ç‚¹æ¨è</h2>
            <!-- è­¦å‘Šæ¡†æ ·å¼å·²æ›´æ–° -->
            <div class="movie-warning">
                <i class="fas fa-exclamation-triangle"></i> <strong>æ³¨æ„:</strong> ä»¥ä¸‹ç½‘ç«™éæœ¬ç«™æ‰€æœ‰ï¼Œå†…å®¹å¯èƒ½åŒ…å«å¹¿å‘Šã€å¼¹çª—æˆ–æ½œåœ¨é£é™©ï¼Œè¯·è°¨æ…è®¿é—®å’Œä½¿ç”¨ï¼
            </div>
             <!--
                ä¿®æ”¹/æ·»åŠ /åˆ é™¤ æ¨èç½‘ç«™:
                1. å¤åˆ¶ä¸‹é¢çš„ä¸€ä¸ª <a ... </a> æ ‡ç­¾å— (ä» <a href=...> å¼€å§‹ï¼Œåˆ° </a> ç»“æŸ)ã€‚
                2. ä¿®æ”¹ href="ç½‘ç«™é“¾æ¥" ä¸­çš„ "ç½‘ç«™é“¾æ¥"ã€‚
                3. ä¿®æ”¹ <div class="movie-card-image"><i class="å›¾æ ‡ç±»å"></i></div> ä¸­çš„ "å›¾æ ‡ç±»å"ã€‚ä½ å¯ä»¥ä» Font Awesome å®˜ç½‘ (fontawesome.com) æŸ¥æ‰¾å…è´¹å›¾æ ‡ï¼Œä¾‹å¦‚ fas fa-film, fas fa-video, fas fa-desktop ç­‰ã€‚
                4. ä¿®æ”¹ <h3 class="movie-card-title">ç½‘ç«™åç§°</h3> ä¸­çš„ "ç½‘ç«™åç§°"ã€‚
                5. ä¿®æ”¹ <span class="movie-card-link">ç½‘ç«™åŸŸå</span> ä¸­çš„ "ç½‘ç«™åŸŸå" (é€šå¸¸å’Œé“¾æ¥ä¸€è‡´)ã€‚
                6. è¦åˆ é™¤ç½‘ç«™æ¨èï¼Œç›´æ¥åˆ é™¤å¯¹åº”çš„ <a ... </a> å—å³å¯ã€‚
            -->
            <div class="card-grid">
                <!-- æ¨èç½‘ç«™ 1 -->
                <a href="https://vip1280.net/" target="_blank" rel="noopener noreferrer" class="movie-card">
                    <div class="movie-card-image"><i class="fas fa-film"></i></div>
                    <div class="movie-card-content">
                        <h3 class="movie-card-title">å½±è§†ç«™ 1</h3>
                        <span class="movie-card-link">vip1280.net</span>
                    </div>
                </a>
                <!-- æ¨èç½‘ç«™ 2 -->
                <a href="https://wniutv.com/" target="_blank" rel="noopener noreferrer" class="movie-card">
                    <div class="movie-card-image"><i class="fas fa-video"></i></div>
                    <div class="movie-card-content">
                        <h3 class="movie-card-title">å½±è§†ç«™ 2</h3>
                        <span class="movie-card-link">wniutv.com</span>
                    </div>
                </a>
                <!-- æ¨èç½‘ç«™ 3 -->
                <a href="https://www.hainatv.net/" target="_blank" rel="noopener noreferrer" class="movie-card">
                     <div class="movie-card-image"><i class="fas fa-desktop"></i></div>
                    <div class="movie-card-content">
                        <h3 class="movie-card-title">å½±è§†ç«™ 3</h3>
                        <span class="movie-card-link">hainatv.net</span>
                    </div>
                </a>
                <!-- æ¨èç½‘ç«™ 4 -->
                <a href="https://www.yfsp.lv/" target="_blank" rel="noopener noreferrer" class="movie-card">
                     <div class="movie-card-image"><i class="fas fa-compact-disc"></i></div>
                    <div class="movie-card-content">
                        <h3 class="movie-card-title">å½±è§†ç«™ 4 [æ¨è]</h3>
                        <span class="movie-card-link">yfsp.lv</span>
                    </div>
                </a>
                <!-- åœ¨è¿™é‡Œæ·»åŠ æ–°çš„æ¨èç½‘ç«™å¡ç‰‡ -->
                <!-- æ¨èç½‘ç«™ 5 -->
                <a href="https://www.fsyuyou.com/" target="_blank" rel="noopener noreferrer" class="movie-card">
                    <div class="movie-card-image"><i class="fas fa-play"></i></div>
                    <div class="movie-card-content">
                        <h3 class="movie-card-title">å½±è§†ç«™ 5 [æ¨è]</h3>
                        <span class="movie-card-link">fsyuyou.com</span>
                    </div>
                </a>
                <!-- æ¨èç½‘ç«™ 6 -->
                <a href="https://www.luhuitang.com/" target="_blank" rel="noopener noreferrer" class="movie-card">
                    <div class="movie-card-image"><i class="fas fa-ticket-alt"></i></div>
                    <div class="movie-card-content">
                        <h3 class="movie-card-title">å½±è§†ç«™ 6</h3>
                        <span class="movie-card-link">luhuitang.com</span>
                    </div>
                </a>
                <!-- æ¨èç½‘ç«™ 7 -->
                <a href="https://www.yingshidaquantv.com/" target="_blank" rel="noopener noreferrer" class="movie-card">
                    <div class="movie-card-image"><i class="fas fa-photo-video"></i></div>
                    <div class="movie-card-content">
                        <h3 class="movie-card-title">å½±è§†ç«™ 7 [æ¨è]</h3>
                        <span class="movie-card-link">yingshidaquantv.com</span>
                    </div>
                </a>
                <!-- æ¨èç½‘ç«™ 8 -->
                <a href="https://www.yhdm.mom/" target="_blank" rel="noopener noreferrer" class="movie-card">
                    <div class="movie-card-image"><i class="fas fa-star"></i></div>
                    <div class="movie-card-content">
                        <h3 class="movie-card-title">å½±è§†ç«™ 8 [æ¨è]</h3>
                        <span class="movie-card-link">yhdm.mom</span>
                    </div>
                </a>
            </div>
        </section>

        <!-- é¡µè„šæ ·å¼å·²æ›´æ–° -->
        <footer>
            <p>å…è´£å£°æ˜ï¼šæœ¬ç«™ä»…æä¾›è§†é¢‘è§£ææŠ€æœ¯å­¦ä¹ ä¸æ¼”ç¤ºï¼Œä¸å­˜å‚¨ä»»ä½•è§†é¢‘èµ„æºã€‚æ‰€æœ‰è§£æç»“æœå‡æ¥è‡ªç¬¬ä¸‰æ–¹æ¥å£ï¼Œæœ¬ç«™ä¸å¯¹å…¶å†…å®¹å’Œå¯ç”¨æ€§è´Ÿè´£ã€‚è¯·å‹¿å°†æœ¬ç«™ç”¨äºä»»ä½•å•†ä¸šæˆ–éæ³•ç”¨é€”ï¼Œå¦åˆ™åæœè‡ªè´Ÿã€‚</p>
            <p>&copy; 2024 ZXYè§†é¢‘ç½‘ç«™. All Rights Reserved.</p>
        </footer>
    </main>

<script>
// JavaScript éƒ¨åˆ†ä¿æŒä¸å˜ï¼Œä»…åœ¨ <select> å’Œ <option> ä¸­æ·»åŠ äº†æ¨è/å¤‡ç”¨æ ‡è®°æ–‡æœ¬ï¼Œå¹¶è°ƒæ•´äº†ç§»åŠ¨ç«¯æç¤ºæ–‡æœ¬
(function() {
    'use strict';

    // --- Configuration ---
    const isMobile = /Mobi|Android/i.test(navigator.userAgent);
    const interfaceTestTimeout = 6000; // Timeout for interface testing (ms)
    // ä» HTML çš„ <option> æ ‡ç­¾ä¸­è·å–æ ‡è®°ä¸º data-restricted-mobile="true" çš„æ¥å£ value
    const restrictedMobileInterfaces = Array.from(document.querySelectorAll('#parserInterface option[data-restricted-mobile="true"]'))
                                           .map(option => option.value);
    // Mark interfaces known to sometimes require loading the URL twice
    // !! è¯·æ ¹æ®å®é™…æµ‹è¯•æƒ…å†µè°ƒæ•´è¿™ä¸ªåˆ—è¡¨ !!
    const doubleParseInterfaces = [
        // "https://jx.xmflv.com/?url=", // ç¤ºä¾‹ï¼Œå¦‚æœéœ€è¦åŒé‡åŠ è½½åˆ™å–æ¶ˆæ³¨é‡Š
        // "https://jx.xmflv.cc/?url=", // ç¤ºä¾‹
        // "https://www.yemu.xyz/?url=", // ç¤ºä¾‹
    ];
    // è®¾ç½®ä¸€ä¸ªåœ¨ç§»åŠ¨ç«¯ç›¸å¯¹å®‰å…¨çš„é»˜è®¤æ¥å£ (ç¡®ä¿è¿™ä¸ª value åœ¨ <select> ä¸­å­˜åœ¨)
    const defaultMobileInterface = "https://bd.jx.cn/?url="; // ç¤ºä¾‹ï¼Œè¯·æ ¹æ®å®é™…æƒ…å†µé€‰æ‹©

    // --- DOM Elements ---
    const interfaceSelect = document.getElementById('parserInterface');
    const videoUrlInput = document.getElementById('videoUrl');
    const parseButton = document.getElementById('parseButton');
    const autoTestButton = document.getElementById('autoTestButton');
    const videoContainer = document.getElementById('videoContainer');
    const videoPlayer = document.getElementById('videoPlayer');
    const loadingMessage = document.getElementById('loadingMessage');
    const testingMessage = document.getElementById('testingInterfaceMessage');
    const successMessage = document.getElementById('successMessage');
    const errorMessage = document.getElementById('errorMessage');
    const errorText = document.getElementById('errorText');

    // --- Core Parsing Logic ---
    let currentParseTimeout = null; // Timeout ID for iframe loading

    /**
     * Loads URL into iframe, handling timeout and errors.
     * @param {string} interfaceUrl - Base URL of the parsing interface.
     * @param {string} videoUrl - Full URL of the video to parse.
     * @returns {Promise<void>} Resolves on successful load, rejects on error/timeout.
     */
    function _loadVideoInIframe(interfaceUrl, videoUrl) {
        return new Promise((resolve, reject) => {
            clearTimeout(currentParseTimeout);
            const parsedUrl = interfaceUrl + encodeURIComponent(videoUrl);
            console.log(`Attempting to load: ${parsedUrl}`);
            videoPlayer.src = 'about:blank'; // Clear previous content

            setTimeout(() => { videoPlayer.src = parsedUrl; }, 50); // Slight delay

            videoContainer.style.display = 'block'; // Show container early

            let resolved = false; // Flag to prevent double resolution/rejection
            const timeoutId = setTimeout(() => {
                if (resolved) return;
                resolved = true;
                console.warn(`Iframe timeout for ${parsedUrl}`);
                removeListeners();
                videoPlayer.src = 'about:blank';
                reject(new Error(`è§£æè¶…æ—¶ (${interfaceTestTimeout / 1000}ç§’)ï¼Œè¯·å°è¯•å…¶ä»–æ¥å£ã€‚`));
            }, interfaceTestTimeout);

            currentParseTimeout = timeoutId; // Store timeout ID globally for potential clearing

            const onLoad = () => {
                if (resolved) return;
                // Sometimes 'load' fires even on failure (e.g., blocked frame), add a small check
                try {
                    // Accessing contentDocument might fail for cross-origin iframes that didn't load properly
                     if (videoPlayer.contentDocument && videoPlayer.contentDocument.readyState === 'complete') {
                          console.log(`Iframe loaded successfully: ${parsedUrl}`);
                     } else if (videoPlayer.contentWindow && videoPlayer.contentWindow.length > 0) {
                         // If it has some content window elements, might be okay
                         console.log(`Iframe loaded (basic check passed): ${parsedUrl}`);
                     }
                     else {
                         // If contentDocument access fails or readyState isn't complete, it might still be loading or blocked
                         console.log(`Iframe 'load' event fired, but content seems inaccessible or not ready: ${parsedUrl}`);
                         // We might still resolve here, relying on the timeout for definite failures
                     }
                } catch (e) {
                    console.warn(`Iframe 'load' event fired but content access failed (likely cross-origin block on failure): ${parsedUrl}`, e);
                    // Resolve anyway, let the user see if it works. Timeout handles catastrophic failures.
                }
                 resolved = true;
                 clearTimeout(timeoutId);
                 removeListeners();
                 resolve();
            };

            const onError = (event) => {
                if (resolved) return;
                resolved = true;
                console.error(`Iframe error for ${parsedUrl}:`, event);
                clearTimeout(timeoutId);
                removeListeners();
                reject(new Error('è§£ææ¥å£åŠ è½½å¤±è´¥ï¼Œå¯èƒ½æ˜¯æ¥å£å¤±æ•ˆæˆ–ç½‘ç»œé—®é¢˜ã€‚'));
            };

            const removeListeners = () => {
                videoPlayer.removeEventListener('load', onLoad);
                videoPlayer.removeEventListener('error', onError);
            };

            videoPlayer.addEventListener('load', onLoad);
            videoPlayer.addEventListener('error', onError);
        });
    }


    /**
     * Main function to parse the video using a selected interface.
     * @param {string} interfaceUrl - The selected parsing interface URL.
     * @returns {Promise<void>} Resolves if parsing initiates successfully. Rejects on failure.
     */
    async function parseVideo(interfaceUrl) {
        const videoUrl = videoUrlInput.value.trim();
        hideAllStatusMessages();

        if (!videoUrl) {
            showError('è¯·è¾“å…¥æœ‰æ•ˆçš„è§†é¢‘é“¾æ¥ï¼');
            return Promise.reject(new Error('No video URL'));
        }

        let fullUrl = videoUrl;
        if (!videoUrl.startsWith('http://') && !videoUrl.startsWith('https://')) {
            fullUrl = `https://${videoUrl}`; // Simple protocol prepending
            console.log(`Prepended https:// to URL: ${fullUrl}`);
        }

        disableButtons(true);
        showLoading();

        try {
            // Double parsing logic (if needed for specific interfaces)
            if (doubleParseInterfaces.includes(interfaceUrl)) {
                console.log(`Using double parse for interface: ${interfaceUrl}`);
                try {
                    await _loadVideoInIframe(interfaceUrl, fullUrl);
                    // Optional delay: await new Promise(resolve => setTimeout(resolve, 300));
                    console.log("First parse attempt finished, starting second...");
                    await _loadVideoInIframe(interfaceUrl, fullUrl);
                    console.log("Second parse attempt finished.");
                } catch (doubleParseError) {
                    console.error("Error during double parse:", doubleParseError);
                    throw doubleParseError; // Re-throw to be caught below
                }
            } else {
                console.log(`Using single parse for interface: ${interfaceUrl}`);
                await _loadVideoInIframe(interfaceUrl, fullUrl);
            }

            hideLoading();
            // Success is implied by video container showing and loading message hiding
            // Scroll to video player after successful parsing
             videoContainer.scrollIntoView({ behavior: 'smooth', block: 'center' });
            disableButtons(false);
            return Promise.resolve(); // Indicate success initiation

        } catch (err) {
            console.error('Parsing failed:', err);
            showError(err.message || 'è§£æè§†é¢‘æ—¶å‘ç”ŸæœªçŸ¥é”™è¯¯ã€‚');
            hideLoading();
            videoContainer.style.display = 'none'; // Hide container on definite error
            videoPlayer.src = 'about:blank';
            disableButtons(false);
            return Promise.reject(err); // Propagate rejection
        }
    }


    /**
     * Automatically tests available interfaces to find one that works.
     */
    async function autoTestInterfaces() {
        const videoUrl = videoUrlInput.value.trim();
        if (!videoUrl) {
            showError('è¯·å…ˆè¾“å…¥è§†é¢‘é“¾æ¥å†è¿›è¡Œæµ‹è¯•ï¼');
            return;
        }

        hideAllStatusMessages();
        showTestingInterface();
        disableButtons(true);

        // Get all options, filter out restricted ones if on mobile
        const options = Array.from(interfaceSelect.options);
        const interfacesToTest = options
            .filter(option => !(isMobile && restrictedMobileInterfaces.includes(option.value)))
            .map(option => ({ value: option.value, text: option.text }));

         if (interfacesToTest.length === 0) {
            showError('å½“å‰è®¾å¤‡æ²¡æœ‰å¯ç”¨çš„è‡ªåŠ¨æµ‹è¯•æ¥å£ã€‚');
            hideTestingInterface();
            disableButtons(false);
            return;
        }

        console.log("Starting auto-test with interfaces:", interfacesToTest.map(i => i.text));
        let bestInterface = null;

        for (const iface of interfacesToTest) {
            console.log(`Testing interface: ${iface.text} (${iface.value})`);
            testingMessage.innerHTML = `<i class="fas fa-vial fa-fw"></i> æ­£åœ¨æµ‹è¯•æ¥å£: ${iface.text}...`; // Update testing message

            try {
                // Use parseVideo which includes timeout and error handling
                // We need to provide a valid URL for testing, even if it's just the base
                await parseVideo(iface.value); // parseVideo now returns a promise
                // If parseVideo resolves without error, consider it successful for auto-test
                bestInterface = iface.value;
                console.log(`Interface ${iface.text} succeeded.`);
                break; // Stop testing on the first success
            } catch (error) {
                console.warn(`Interface ${iface.text} failed: ${error.message}`);
                // Hide video container immediately if this test fails
                videoContainer.style.display = 'none';
                videoPlayer.src = 'about:blank';
                // Continue to the next interface
            }
        }

        hideTestingInterface(); // Hide the "testing..." message

        if (bestInterface) {
            interfaceSelect.value = bestInterface;
            showSuccessMessage(); // Show success confirmation
            // The successful parseVideo call would have already displayed the video
            // Ensure the video remains visible and scroll to it
            videoContainer.style.display = 'block';
            videoContainer.scrollIntoView({ behavior: 'smooth', block: 'center' });
            // Need to ensure buttons are enabled AFTER success message shows
             disableButtons(false);
        } else {
            showError('æ‰€æœ‰å¯ç”¨æ¥å£æµ‹è¯•å¤±è´¥ï¼Œè¯·æ£€æŸ¥é“¾æ¥æˆ–æ‰‹åŠ¨é€‰æ‹©æ¥å£å°è¯•ã€‚');
            videoContainer.style.display = 'none'; // Ensure container is hidden if all fail
            videoPlayer.src = 'about:blank';
             disableButtons(false); // Re-enable buttons on failure too
        }
    }

    // --- UI Helper Functions ---
    function showLoading() { hideAllStatusMessages(); loadingMessage.style.display = 'flex'; } // Changed to flex
    function hideLoading() { loadingMessage.style.display = 'none'; }
    function showTestingInterface() { hideAllStatusMessages(); testingMessage.style.display = 'flex'; testingMessage.innerHTML = '<i class="fas fa-vial fa-fw"></i> æ­£åœ¨è‡ªåŠ¨æµ‹è¯•æ¥å£...'; } // Changed to flex
    function hideTestingInterface() { testingMessage.style.display = 'none'; }

    function showSuccessMessage() {
        hideAllStatusMessages();
        successMessage.style.display = 'flex'; // Changed to flex
        setTimeout(() => { if (successMessage.style.display === 'flex') successMessage.style.display = 'none'; }, 3500);
    }

    function showError(message) {
        hideAllStatusMessages();
        errorText.textContent = message;
        errorMessage.style.display = 'flex'; // Changed to flex
        // Keep error message visible longer
        setTimeout(() => { if (errorMessage.style.display === 'flex') errorMessage.style.display = 'none'; }, 7000);
    }

    function hideAllStatusMessages() {
        loadingMessage.style.display = 'none';
        testingMessage.style.display = 'none';
        successMessage.style.display = 'none';
        errorMessage.style.display = 'none';
    }

    function disableButtons(disabled) {
        parseButton.disabled = disabled;
        autoTestButton.disabled = disabled;
    }

    /**
     * Handles mobile confirmation logic.
     * @param {string} selectedValue - Value of the selected interface.
     * @returns {boolean} True if parsing should proceed, false otherwise.
     */
    function checkMobileRestriction(selectedValue) {
        if (isMobile && restrictedMobileInterfaces.includes(selectedValue)) {
            const selectedOption = interfaceSelect.options[interfaceSelect.selectedIndex];
            // Extract text before the mobile icon if it exists
            const optionText = selectedOption ? selectedOption.text.replace(/\s*<span class="mobile-indicator">.*?<\/span>/i, '').replace(/\s*ğŸ“±.*/, '').trim() : 'è¯¥æ¥å£';
            const confirmMessage = `æ‚¨å½“å‰ä½¿ç”¨çš„æ˜¯ç§»åŠ¨è®¾å¤‡ï¼Œé€‰æ‹©çš„ "${optionText}" å¯èƒ½åŒ…å«ä¸é€‚åˆæ‰‹æœºæµè§ˆçš„å†…å®¹æˆ–å¹¿å‘Šè¾ƒå¤šã€‚\n\nç¡®å®šè¦ç»§ç»­ä½¿ç”¨å—ï¼Ÿ`;
            if (!confirm(confirmMessage)) {
                // Optionally reset to default if user cancels
                // if (Array.from(interfaceSelect.options).some(opt => opt.value === defaultMobileInterface)) {
                //     interfaceSelect.value = defaultMobileInterface;
                //     updateMobileIndicator(); // Update indicator if selection changed
                // }
                return false; // Do not proceed
            }
        }
        return true; // Proceed
    }

    // Function to add/remove mobile indicator icon dynamically (if needed)
    function updateMobileIndicator() {
        Array.from(interfaceSelect.options).forEach(option => {
            const mobileIndicatorClass = 'mobile-indicator-text'; // Use a class for easier selection/removal
            // Remove existing text indicator first
            option.textContent = option.textContent.replace(` ${String.fromCodePoint(0x1F4F5)}`, '').trim();
            option.classList.remove('restricted-mobile'); // Reset class

            if (isMobile && restrictedMobileInterfaces.includes(option.value)) {
                option.classList.add('restricted-mobile');
                // Add Unicode character back if not already present
                if (!option.textContent.includes(String.fromCodePoint(0x1F4F5))) {
                    option.textContent += ` ${String.fromCodePoint(0x1F4F5)}`; // Add mobile phone with arrow emoji
                }
            }
        });
    }


    // --- Event Listeners ---
    function initEventListeners() {
        parseButton.addEventListener('click', () => {
            const selectedInterface = interfaceSelect.value;
            if (checkMobileRestriction(selectedInterface)) {
                 parseVideo(selectedInterface).catch(err => {
                    // Error already handled visually in parseVideo
                    console.log("Parse button click resulted in error (handled).");
                 });
            } else {
                console.log("Mobile restriction cancelled by user.");
                 // Ensure buttons are re-enabled if confirm is cancelled
                 disableButtons(false);
            }
        });

        autoTestButton.addEventListener('click', autoTestInterfaces);

        // Update mobile indicator on select change
        interfaceSelect.addEventListener('change', updateMobileIndicator);

        videoUrlInput.focus(); // Auto-focus URL input on load
    }

    // --- Initialization ---
    document.addEventListener('DOMContentLoaded', () => {
        // Apply mobile specific UI adjustments on load
        updateMobileIndicator();

        // Set a safer default interface on mobile if the current default is restricted
        if (isMobile && restrictedMobileInterfaces.includes(interfaceSelect.value)) {
             // Check if defaultMobileInterface exists before setting it
             if (Array.from(interfaceSelect.options).some(opt => opt.value === defaultMobileInterface)) {
                interfaceSelect.value = defaultMobileInterface;
                updateMobileIndicator(); // Update indicators after changing default
             }
        }

        initEventListeners();
        console.log("ZXY Video Parser Initialized. Mobile:", isMobile);
        console.log("Restricted Mobile Interfaces:", restrictedMobileInterfaces);
    });

})();
</script>

</body>
</html>
